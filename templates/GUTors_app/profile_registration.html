{% extends 'GUTors_app/base.html' %}

{% load static %}

{% block title_block %}
    {% if is_edit %}
        Edit Your Profile
    {% else %}
        Create Profile
    {% endif %}
{% endblock %}

{% block body_block %}
<div class="container profile-form-container mt-5">
    <div class="card p-4 shadow-lg bg-light">
        <h2 class="text-center text-dark">
            {% if is_edit %}
                Edit Your Profile
            {% else %}
                Register Here - Step 2
            {% endif %}
        </h2>
        
        <!-- Profile Picture Preview -->
        <div class="text-center">
            <img id="avatarPreview" src="{% static 'images/default-avatar.png' %}" alt="Profile Picture Preview" class="avatar-preview">
        </div>

        <form method="post"
              action="{% url 'GUTors:register_profile' %}"
              enctype="multipart/form-data"
              class="mt-3">
            {% csrf_token %}
            
            <div class="form-group">
                {{ form.as_p }}
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-profile-submit">
                    {% if is_edit %}Update Profile{% else %}Create Profile{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>

<!-- JavaScript for Live Profile Picture Preview -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const fileInput = document.querySelector("input[type='file']");
        const previewImage = document.getElementById("avatarPreview");

        fileInput.addEventListener("change", function (event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    previewImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
    });
</script>
{% endblock %}
